{"version":3,"sources":["../src/collapsible_content.js"],"names":[],"mappings":"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","file":"collapsible_content.js","sourcesContent":["const _    = require(\"lodash/core\");\n_.includes = require(\"lodash/includes\");\n\nconst ViewportDetectionClass = require(\"viewport-detection-es6\");\nconst viewport = new ViewportDetectionClass();\n\nclass CollapsibleContentClass {\n  constructor(config = {}, init = true) {\n    this.config = _.defaults(config,\n      { bodyContainerClass: \"collapsible-content-body\" },\n      { itemContainerClass: \"collapsible-content-item\" },\n      { toggleContainerClass: \"collapsible-content-toggle\" }\n    );\n\n    if(init) {\n      this._initViewport();\n      this._init();\n    }\n  }\n\n  render() {\n    this._getItems();\n    this._getToggles();\n    this._getBodies();\n    this._setBreakpointDefaults();\n  }\n\n  _addToggleClickListeners() {\n    _.forEach(this.toggles, function(toggle) {\n      toggle.addEventListener(\"click\", this._toggleClick.bind(this, toggle), false);\n    }.bind(this));\n  }\n\n  _getBodies() {\n    _.forEach(this.items, function(item) {\n      this.bodies.push(item.querySelector(\".\" + this.config.bodyContainerClass));\n    }.bind(this));\n\n    this._setBodyClasses();\n  }\n\n  _getItems() {\n    let dataParent;\n    let items = this.config.element.querySelectorAll(\".\" + this.config.itemContainerClass);\n\n    _.forEach(items, function(item) {\n      dataParent = item.getAttribute(\"data-parent\");\n\n      if(dataParent === this.dataName) {\n        this.items.push(item);\n      }\n    }.bind(this));\n\n    this._setVisibleItems();\n  }\n\n  _getToggles() {\n    _.forEach(this.items, function(item) {\n      this.toggles.push(item.querySelector(\".\" + this.config.toggleContainerClass));\n    }.bind(this));\n\n    this._setToggleAriaControls();\n    this._addToggleClickListeners();\n  }\n\n  _init() {\n    this.bodies = [];\n    this.items = [];\n    this.toggles = [];\n    this.dataName = this.config.element.getAttribute(\"data-name\");\n    this.render();\n  }\n\n  _initViewport() {\n    this.device = viewport.getDevice();\n    this.size = viewport.windowSize();\n    viewport.trackSize(this._trackSize.bind(this));\n  }\n\n  _setBodyAriaHidden(toggle) {\n    let body = this._skipTextNodes(toggle.nextSibling, \"nextSibling\");\n    let attribute = body.getAttribute(\"aria-hidden\");\n\n    body.setAttribute(\"aria-hidden\", (attribute === \"true\") ? \"false\" : \"true\");\n  }\n\n  _setBodyClass(toggle) {\n    let body = this._skipTextNodes(toggle.nextSibling, \"nextSibling\");\n    let className = body.className;\n\n    if(_.includes(className, \"open\")) {\n      body.className = className.replace(/(?:^|\\s)open(?!\\S)/g, \"\");\n    } else {\n      body.className = className += \" open\";\n    }\n  }\n\n  _setBodyClasses() {\n    _.forEach(this.bodies, function(body, i) {\n      body.className += (!_.isNull(this.dataName)) ? \" \" + this.dataName + \"-collapsible-\" + i : \" collapsible-\" + i;\n    }.bind(this));\n  }\n\n  _setBreakpointDefaults() {\n    switch(this.device) {\n      case \"mobile\":\n        this._setDefaults(this.visibleMobile);\n        break;\n      case \"tablet\":\n        this._setDefaults(this.visibleTablet);\n        break;\n      case \"desktop\":\n        this._setDefaults(this.visibleDesktop);\n        break;\n    }\n  }\n\n  _setDefaultBodyAriaHiddens(visible) {\n    _.forEach(this.bodies, function(body) {\n      body.setAttribute(\"aria-hidden\", (visible === \"true\") ? \"false\" : \"true\");\n    }.bind(this));\n  }\n\n  _setDefaultBodyClasses(visible) {\n    _.forEach(this.bodies, function(body) {\n      let className = body.className;\n\n      if(visible === \"true\") {\n        if(!_.includes(className, \"open\")) {\n          body.className = className += \" open\";\n        }\n      } else {\n        body.className = className.replace(/(?:^|\\s)open(?!\\S)/g, \"\");\n      }\n    }.bind(this));\n  }\n\n  _setDefaults(visible) {\n    this._setDefaultToggleAriaExpandeds(visible);\n    this._setDefaultToggleClasses(visible);\n    this._setDefaultBodyAriaHiddens(visible);\n    this._setDefaultBodyClasses(visible);\n  }\n\n  _setDefaultToggleAriaExpandeds(visible) {\n    _.forEach(this.toggles, function(toggle) {\n      toggle.setAttribute(\"aria-expanded\", (visible === \"true\") ? \"true\" : \"false\");\n    }.bind(this));\n  }\n\n  _setDefaultToggleClasses(visible) {\n    _.forEach(this.toggles, function(toggle) {\n      let className = toggle.className;\n\n      if(visible === \"true\") {\n        if(!_.includes(className, \"open\")) {\n          toggle.className = className += \" open\";\n        }\n      } else {\n        toggle.className = className.replace(/(?:^|\\s)open(?!\\S)/g, \"\");\n      }\n    }.bind(this));\n  }\n\n  _setToggleAriaControls() {\n    _.forEach(this.toggles, function(toggle, i) {\n      toggle.setAttribute(\"aria-controls\", (!_.isNull(this.dataName)) ? this.dataName + \"-collapsible-\" + i : \"collapsible-\" + i);\n    }.bind(this));\n  }\n\n  _setToggleAriaExpanded(toggle) {\n    let attribute = toggle.getAttribute(\"aria-expanded\");\n\n    toggle.setAttribute(\"aria-expanded\", (attribute === \"true\") ? \"false\" : \"true\");\n  }\n\n  _setToggleClass(toggle) {\n    let className = toggle.className;\n\n    if(_.includes(className, \"open\")) {\n      toggle.className = className.replace(/(?:^|\\s)open(?!\\S)/g, \"\");\n    } else {\n      toggle.className = className += \" open\";\n    }\n  }\n\n  _setVisibleItems() {\n    let visibleMobile = this.config.element.getAttribute(\"data-visible-mobile\");\n    let visibleTablet = this.config.element.getAttribute(\"data-visible-tablet\");\n    let visibleDesktop = this.config.element.getAttribute(\"data-visible-desktop\");\n\n    this.visibleMobile = (!_.isNull(visibleMobile)) ? visibleMobile : \"false\";\n    this.visibleTablet = (!_.isNull(visibleTablet)) ? visibleTablet : \"false\";\n    this.visibleDesktop = (!_.isNull(visibleDesktop)) ? visibleDesktop : \"false\";\n  }\n\n  _skipTextNodes(el, method) {\n    let element = el[method];\n\n    while(element !== null && element.nodeType !== 1) {\n      element = element.nextSibling;\n    }\n\n    return element;\n  }\n\n  _toggleClick(toggle, e) {\n    e.preventDefault();\n\n    this._setToggleAriaExpanded(toggle);\n    this._setToggleClass(toggle);\n    this._setBodyAriaHidden(toggle);\n    this._setBodyClass(toggle);\n  }\n\n  _trackSize(device, size) {\n    if(this.device !== device) {\n      this.device = device;\n\n      this._setBreakpointDefaults();\n    }\n\n    this.size = size;\n  }\n}\n\nmodule.exports = CollapsibleContentClass;"]}